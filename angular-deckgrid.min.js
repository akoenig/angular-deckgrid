/*! angular-deckgrid (v0.6.0) - Copyright: 2013 - 2016, André König (andre.koenig@posteo.de) / Mark Hamilton (mark@dryverless.com) - MIT */
angular.module("akoenig.deckgrid",[]),angular.module("akoenig.deckgrid").directive("deckgrid",["DeckgridDescriptor",function(b){"use strict";return b.create()}]),angular.module("akoenig.deckgrid").factory("DeckgridDescriptor",["Deckgrid","$templateCache",function(b,c){"use strict";function d(){this.restrict="AE",this.template='<div data-ng-repeat="column in columns" class="{{layout.classList}}"><div data-ng-repeat="card in column" data-ng-include="cardTemplate"></div></div>',this.scope={model:"=source",filter:"=",orderBy:"="},this.$$deckgrid=null,this.transclude=!0,this.link=this.$$link.bind(this),this.$$templateKeyIndex=0}return d.prototype.$$link=function(d,e,f,g,h){var i="deckgrid/innerHtmlTemplate"+ ++this.$$templateKeyIndex+".html";angular.isUndefined(f.cardtemplate)?(angular.isUndefined(f.cardtemplatestring)?h(d,function(b){var g,d=[],e=0,f=b.length;for(e;e<f;e+=1)g=b[e].outerHTML,angular.isDefined(g)&&d.push(g);c.put(i,d.join())}):c.put(i,e.attr("cardtemplatestring")),d.cardTemplate=i):d.cardTemplate=f.cardtemplate,d.mother=d.$parent,this.$$deckgrid=b.create(d,e[0]),d.$on("$destroy",this.$$deckgrid.destroy.bind(this.$$deckgrid))},{create:function(){return new d}}}]),angular.module("akoenig.deckgrid").factory("Deckgrid",["$window","$log","$filter",function(b,c,d){"use strict";function e(a,c){var e,f,g,h,d=this;this.$$elem=c,this.$$watchers=[],this.$$scope=a,this.$$scope.columns=[],this.$$scope.layout=this.$$getLayout(),this.$$createColumns(),e=this.$$scope.$watchCollection("model",this.$$onModelChange.bind(this)),this.$$watchers.push(e),f=this.$$scope.$watchCollection("filter",this.$$onModelChange.bind(this)),g=this.$$scope.$watchCollection("orderBy",this.$$onModelChange.bind(this)),this.$$watchers.push(f),this.$$watchers.push(g),angular.forEach(d.$$getMediaQueries(),function(b){function e(){b.removeListener(c)}var c=d.$$onMediaQueryChange.bind(d);b.addListener(c),d.$$watchers.push(e)}),h=b.matchMedia("(orientation: portrait)"),h.addListener(d.$$onMediaQueryChange.bind(d))}return e.prototype.$$getMediaQueries=function(){function e(a){try{return a.sheet.cssRules||[]}catch(a){return[]}}function f(a){var b=/\[(\w*-)?deckgrid\]::?before/g,c=0,d="";if(!a.media||angular.isUndefined(a.cssRules))return!1;for(c=a.cssRules.length-1;c>=0;c-=1)if(d=a.cssRules[c].selectorText,angular.isDefined(d)&&d.match(b))return!0;return!1}var c=[],d=[];return c=Array.prototype.concat.call(Array.prototype.slice.call(document.querySelectorAll("style[type='text/css']")),Array.prototype.slice.call(document.querySelectorAll("link[rel='stylesheet']"))),angular.forEach(c,function(c){var g=e(c);angular.forEach(g,function(c){f(c)&&d.push(b.matchMedia(c.media.mediaText))})}),d},e.prototype.$$createColumns=function(){var b=this;return this.$$scope.layout?(b.$$scope.columns=[],void angular.forEach(d("orderBy")(d("filter")(b.$$scope.model,b.$$scope.filter),b.$$scope.orderBy),function(c,d){var e=d%b.$$scope.layout.columns|0;b.$$scope.columns[e]||(b.$$scope.columns[e]=[]),c.$index=d,b.$$scope.columns[e].push(c)})):c.error("angular-deckgrid: No CSS configuration found (see https://github.com/akoenig/angular-deckgrid#the-grid-configuration)")},e.prototype.$$getLayout=function(){var d,c=b.getComputedStyle(this.$$elem,":before").content;return c&&(c=c.replace(/'/g,""),c=c.replace(/"/g,""),c=c.split(" "),2===c.length&&(d={},d.columns=0|c[0],d.classList=c[1].replace(/\./g," ").trim())),d},e.prototype.$$onMediaQueryChange=function(){var b=this,c=this.$$getLayout();c&&c.columns!==this.$$scope.layout.columns&&(b.$$scope.layout=c,b.$$scope.$apply(function(){b.$$createColumns()}))},e.prototype.$$onModelChange=function(b,c){var d=this;b=b||[],c=c||[],angular.equals(c,b)||d.$$createColumns()},e.prototype.destroy=function(){var b=this.$$watchers.length-1;for(b;b>=0;b-=1)this.$$watchers[b]()},{create:function(b,c){return new e(b,c)}}}]);
